-- DROP TABLE
DROP TABLE BUCKET;
DROP TABLE MESSAGE;
DROP TABLE QNAREPLY;
DROP TABLE TRANSACTIONSTATE;
DROP TABLE RESERVATION;
DROP TABLE REREPLY;
DROP TABLE POSSIBLEDATE;
DROP TABLE ROOM_OPTION;
DROP TABLE REVIEW;
DROP TABLE QNA;
DROP TABLE ROOM;
DROP TABLE MEMBER;

-- DROP SEQUENCE
DROP SEQUENCE SEQ_MESSAGENO;
DROP SEQUENCE SEQ_QNANO;
DROP SEQUENCE SEQ_QNAREPLYNO;
DROP SEQUENCE SEQ_RESERVATIONNO;
DROP SEQUENCE SEQ_ROOMNO;
DROP SEQUENCE SEQ_REVIEWNO;
DROP SEQUENCE SEQ_REREPLYNO;
DROP SEQUENCE SEQ_PONO;


-- CREATE SEQUENCE
-- MESSAGENO SEQEUNCE
CREATE SEQUENCE SEQ_MESSAGENO;
-- QNANO SEQUENCE
CREATE SEQUENCE SEQ_QNANO;
-- QNAREPLYNO SEQUENCE
CREATE SEQUENCE SEQ_QNAREPLYNO;
-- RESERVATIONNO SEQUENCE
CREATE SEQUENCE SEQ_RESERVNO;
-- ROOMNO SEQUENCE
CREATE SEQUENCE SEQ_ROOMNO;
-- REVIEWNO SEQUENCE
CREATE SEQUENCE SEQ_REVIEWNO;
-- REREPLYNO SEQUENCE
CREATE SEQUENCE SEQ_REREPLYNO;
-- PONO SEQUENCE
CREATE SEQUENCE SEQ_PONO;


-- CREATE TABLE
-- MEMBER TABLE
CREATE TABLE MEMBER(
    ID VARCHAR2(50) PRIMARY KEY,
    PASSWORD VARCHAR2(50) NOT NULL,
    NAME VARCHAR2(100) NOT NULL,
    BIRTH VARCHAR2(20) NOT NULL,
    PHONENO NUMBER NOT NULL,
    ADDRESS VARCHAR2(200) NOT NULL,
    EMAIL VARCHAR2(100) NOT NULL,
    BUSINESSNO NUMBER DEFAULT 0
);

-- ROOM TABLE
CREATE TABLE ROOM(
    ROOMNO NUMBER PRIMARY KEY,
    ID CONSTRAINT FK_ROOM_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    FEE NUMBER NOT NULL,
    PIC CLOB NOT NULL,
    LATITUDE VARCHAR2(100) NOT NULL,
    LONGITUDE VARCHAR2(100) NOT NULL,
    CAPACITY NUMBER NOT NULL,
    BEDNO NUMBER NOT NULL,
    BATH NUMBER NOT NULL,
    BEDROOMNO NUMBER NOT NULL,
    CONTENT CLOB NOT NULL,
    ROOMNAME VARCHAR2(100) NOT NULL
 );
 
 -- ROOM_OPTION TABLE
 CREATE TABLE ROOM_OPTION(
    ROOMNO CONSTRAINT FK_OPTION_ROOMNO REFERENCES ROOM(ROOMNO) ON DELETE CASCADE,
    ELEVATOR VARCHAR2(100) NOT NULL,
    WIFI VARCHAR2(100) NOT NULL,
    PARKINGLOT VARCHAR2(100) NOT NULL,
    KITCHEN VARCHAR2(100) NOT NULL,
    PET VARCHAR2(100) NOT NULL,
    TV VARCHAR2(100) NOT NULL,
    WASHER VARCHAR2(100) NOT NULL,
    SMOKING VARCHAR2(100) NOT NULL,
    CONSTRAINT PK_OPTION PRIMARY KEY(ROOMNO)
 );
    
 -- BUCKET TALBE
 CREATE TABLE BUCKET(
    ROOMNO CONSTRAINT FK_BUCKET_ROOMNO REFERENCES ROOM(ROOMNO) ON DELETE CASCADE,
    ID CONSTRAINT FK_BUCKET_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    CONSTRAINT PK_ROOMNO_ID PRIMARY KEY(ROOMNO, ID)
 );
 
 -- MESSAGE TABLE
CREATE TABLE MESSAGE(
    MESSAGENO NUMBER PRIMARY KEY,
    RECIVEID CONSTRAINT FK_MESSAGE_RECIVEID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    SENDID CONSTRAINT FK_MESSAGE_SENDID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    CONTENT CLOB NOT NULL,
    MDATE DATE NOT NULL,
    STATE VARCHAR2(10) NOT NULL
);

-- QNA TABLE
CREATE TABLE QNA(
    QNANO NUMBER PRIMARY KEY,
    ID CONSTRAINT FK_QNA_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    ROOMNO CONSTRAINT FK_QNA_ROOMNO REFERENCES ROOM(ROOMNO) ON DELETE CASCADE,
    CONTENT CLOB NOT NULL,
    PASSWORD VARCHAR2(50),
    QNADATE DATE NOT NULL,
    TITLE VARCHAR2(200) NOT NULL
);

-- QNAREPLY TABLE
CREATE TABLE QNAREPLY(
   QNAREPLYNO NUMBER PRIMARY KEY,
   QNANO CONSTRAINT FK_QNAREPLY_QNANO REFERENCES QNA(QNANO) ON DELETE CASCADE,
   CONTENT CLOB NOT NULL,
   ID CONSTRAINT FK_QNAREPLY_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
   PARENTRENO NUMBER DEFAULT 0,
   QNAREPLYDATE DATE NOT NULL
);

-- TRANSACTIONSTATE
CREATE TABLE TRANSACTIONSTATE(
    STATE NUMBER PRIMARY KEY,
    CONTENT VARCHAR2(20) NOT NULL
);

-- RESERVATION TABLE
CREATE TABLE RESERVATION(
    RESERVNO NUMBER PRIMARY KEY,
    ROOMNO CONSTRAINT FK_RESERVATION_ROOMNO REFERENCES ROOM(ROOMNO) ON DELETE CASCADE,
    ID CONSTRAINT FK_RESERVATION_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    RESERVDATE DATE NOT NULL,
    STATE NUMBER NOT NULL
);

-- REVIEW TABLE
CREATE TABLE REVIEW(
    REVIEWNO NUMBER PRIMARY KEY,
    ROOMNO CONSTRAINT FK_REVIEW_ROOMNO REFERENCES ROOM(ROOMNO)  ON DELETE CASCADE,
    ID CONSTRAINT FK_REVIEW_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    CONTENT CLOB NOT NULL,
    SCORE NUMBER NOT NULL,
    REVIEWDATE DATE NOT NULL
);

-- REREPLY TABLE
CREATE TABLE REREPLY(
    REREPLYNO NUMBER PRIMARY KEY,
    REVIEWNO  CONSTRAINT FK_REREPLY_REVIENO REFERENCES REVIEW(REVIEWNO) ON DELETE CASCADE,
    ID CONSTRAINT FK_REREPLY_ID REFERENCES MEMBER(ID) ON DELETE CASCADE,
    CONTENT CLOB NOT NULL,
    PARENTRENO NUMBER DEFAULT 0,
    REREPLYDATE DATE NOT NULL
 );
 
 -- POSSIBLEDATE TABLE
 CREATE TABLE POSSIBLEDATE(
    PONO NUMBER PRIMARY KEY,
    ROOMNO CONSTRAINT FK_POSSIBLEDATE_ROOMNO REFERENCES ROOM(ROOMNO) ON DELETE CASCADE,
    STARTDAY DATE NOT NULL,
    ENDDAT DATE NOT NULL
);